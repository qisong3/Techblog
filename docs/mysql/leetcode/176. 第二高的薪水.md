---
title: 176. 第二高的薪水
date: 2020-12-01
last-update: 2020-12-01
tags:
 - MySQL
keywords:
 - MySQL
 - leetcode
---
 
## 题目
编写一个 SQL 查询，获取 Employee 表中第二高的薪水（Salary） 。
```
+----+--------+
| Id | Salary |
+----+--------+
| 1  | 100    |
| 2  | 200    |
| 3  | 300    |
+----+--------+
```
例如上述 Employee 表，SQL查询应该返回 200 作为第二高的薪水。如果不存在第二高的薪水，那么查询应返回 null。
```sql
+---------------------+
| SecondHighestSalary |
+---------------------+
| 200                 |
+---------------------+
```
建表语句
```sql
Create table If Not Exists Employee (Id int, Salary int)
Truncate table Employee
insert into Employee (Id, Salary) values ('1', '100')
insert into Employee (Id, Salary) values ('2', '200')
insert into Employee (Id, Salary) values ('3', '300')
```

## 题解

如果是找薪水最高的，直接使用MAX()函数就解决了，找薪水第二高的需要考虑几个情况
- 是否存在第二高的
- 如果最高的薪水有多个，如何剔除

### 思路一  
因为第一高的可能存在多个，所以直接排序取第二个是不可以的。不过可以就着这个思路增加一个对Salary去重，然后再取排序的第二个就可以了。

```sql
SELECT 
(SELECT DISTINCT salary
FROM Employee
ORDER BY Salary DESC
LIMIT 1,1)
as SecondHighestSalary;
```

### 思路二
当然也可以两次使用MySQL的聚合函数Max，然后取小于Max的最大值。
```sql
SELECT Max(Salary) as SecondHighestSalary  FROM Employee WHERE Salary < (SELECT Max(Salary) FROM Employee)
```
::: tip
使用聚合函数是经过MySQL优化器自行优化的，所以速度上有保证
:::

