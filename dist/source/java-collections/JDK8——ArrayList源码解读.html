<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>JDK8——ArrayList源码解读 | Errison&#39;s share</title>
    <meta name="generator" content="VuePress 1.5.2">
    <link rel="icon" href="/logo.png">
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" href="/icons/apple-touch-icon-152x152.png">
    <link rel="mask-icon" href="/icons/safari-pinned-tab.svg" color="#3eaf7c">
    <script>var _hmt = _hmt || [];
            (function() {
              var hm = document.createElement("script");
              hm.src = "https://hm.baidu.com/hm.js?b16f225f97b3c7e88a6ecd6e49d45b37";
              var s = document.getElementsByTagName("script")[0]; 
              s.parentNode.insertBefore(hm, s);
            })();
          </script>
    <meta name="description" content="A place to share IT tech">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/icons/msapplication-icon-144x144.png">
    <meta name="msapplication-TileColor" content="#000000">
    <link rel="preload" href="/assets/css/0.styles.35789c7e.css" as="style"><link rel="preload" href="/assets/js/app.e0118352.js" as="script"><link rel="preload" href="/assets/js/3.3e98eff2.js" as="script"><link rel="preload" href="/assets/js/56.98a84191.js" as="script"><link rel="preload" href="/assets/js/6.8fb5b480.js" as="script"><link rel="prefetch" href="/assets/js/10.a14266e9.js"><link rel="prefetch" href="/assets/js/11.3d1a0af9.js"><link rel="prefetch" href="/assets/js/12.d7a66493.js"><link rel="prefetch" href="/assets/js/13.e8fa261e.js"><link rel="prefetch" href="/assets/js/14.1505d643.js"><link rel="prefetch" href="/assets/js/15.19e77271.js"><link rel="prefetch" href="/assets/js/16.f7f74465.js"><link rel="prefetch" href="/assets/js/17.165ac5ad.js"><link rel="prefetch" href="/assets/js/18.2e024a33.js"><link rel="prefetch" href="/assets/js/19.7de7c7dd.js"><link rel="prefetch" href="/assets/js/20.3d0c1515.js"><link rel="prefetch" href="/assets/js/21.40f44eb2.js"><link rel="prefetch" href="/assets/js/22.624bf4f2.js"><link rel="prefetch" href="/assets/js/23.43748060.js"><link rel="prefetch" href="/assets/js/24.e53cc848.js"><link rel="prefetch" href="/assets/js/25.fb29a9f9.js"><link rel="prefetch" href="/assets/js/26.4e0b31bf.js"><link rel="prefetch" href="/assets/js/27.17806a83.js"><link rel="prefetch" href="/assets/js/28.6a1f07cb.js"><link rel="prefetch" href="/assets/js/29.d73d0981.js"><link rel="prefetch" href="/assets/js/30.dc461366.js"><link rel="prefetch" href="/assets/js/31.05fed964.js"><link rel="prefetch" href="/assets/js/32.b497c95e.js"><link rel="prefetch" href="/assets/js/33.8a4e7ce6.js"><link rel="prefetch" href="/assets/js/34.3657ae07.js"><link rel="prefetch" href="/assets/js/35.09a258ae.js"><link rel="prefetch" href="/assets/js/36.b6bcfb4e.js"><link rel="prefetch" href="/assets/js/37.f4be5a8b.js"><link rel="prefetch" href="/assets/js/38.ae235dc6.js"><link rel="prefetch" href="/assets/js/39.0f542f1a.js"><link rel="prefetch" href="/assets/js/4.4bd02a83.js"><link rel="prefetch" href="/assets/js/40.960801e8.js"><link rel="prefetch" href="/assets/js/41.ce7dda57.js"><link rel="prefetch" href="/assets/js/42.227acbdc.js"><link rel="prefetch" href="/assets/js/43.6074b0f5.js"><link rel="prefetch" href="/assets/js/44.28d2efb5.js"><link rel="prefetch" href="/assets/js/45.f62bcaf0.js"><link rel="prefetch" href="/assets/js/46.1bd87d19.js"><link rel="prefetch" href="/assets/js/47.2c275320.js"><link rel="prefetch" href="/assets/js/48.98ffb8b3.js"><link rel="prefetch" href="/assets/js/49.d748aa2a.js"><link rel="prefetch" href="/assets/js/5.83a396a2.js"><link rel="prefetch" href="/assets/js/50.9342bdde.js"><link rel="prefetch" href="/assets/js/51.18e24f1b.js"><link rel="prefetch" href="/assets/js/52.0aea5e3d.js"><link rel="prefetch" href="/assets/js/53.a4d2c348.js"><link rel="prefetch" href="/assets/js/54.5130b927.js"><link rel="prefetch" href="/assets/js/55.f547c74f.js"><link rel="prefetch" href="/assets/js/57.684aec65.js"><link rel="prefetch" href="/assets/js/58.009f0bdf.js"><link rel="prefetch" href="/assets/js/59.7c1633f9.js"><link rel="prefetch" href="/assets/js/60.6f8c39d5.js"><link rel="prefetch" href="/assets/js/61.eb3a8177.js"><link rel="prefetch" href="/assets/js/62.5e217272.js"><link rel="prefetch" href="/assets/js/7.fa2f0b06.js"><link rel="prefetch" href="/assets/js/8.c4a43e1e.js"><link rel="prefetch" href="/assets/js/9.224f9326.js"><link rel="prefetch" href="/assets/js/vendors~flowchart.1fdfa170.js">
    <link rel="stylesheet" href="/assets/css/0.styles.35789c7e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.png" alt="Errison's share" class="logo"> <span class="site-name can-hide">Errison's share</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="source" class="dropdown-title"><span class="title">源码系列</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          Java源码
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/source/java-collections/" class="nav-link router-link-active">
  集合
</a></li><li class="dropdown-subitem"><a href="/source/java-wrapper/" class="nav-link">
  包装类
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="algorithm" class="dropdown-title"><span class="title">算法</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          数据结构
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/algorithm/array/" class="nav-link">
  数组
</a></li><li class="dropdown-subitem"><a href="/algorithm/stack.html" class="nav-link">
  栈
</a></li><li class="dropdown-subitem"><a href="/algorithm/heap/" class="nav-link">
  堆
</a></li><li class="dropdown-subitem"><a href="/algorithm/tree.html" class="nav-link">
  树
</a></li><li class="dropdown-subitem"><a href="/algorithm/graph.html" class="nav-link">
  图
</a></li><li class="dropdown-subitem"><a href="/algorithm/hashtable.html" class="nav-link">
  哈希表
</a></li></ul></li><li class="dropdown-item"><h4>
          算法
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/algorithm/greedy.html" class="nav-link">
  贪心
</a></li><li class="dropdown-subitem"><a href="/algorithm/backtracking.html" class="nav-link">
  回溯
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="java" class="dropdown-title"><span class="title">Java专题</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          Java基础
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/java/history/" class="nav-link">
  Java简史
</a></li></ul></li><li class="dropdown-item"><h4>
          Java深入
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/java/review/" class="nav-link">
  面试集锦
</a></li><li class="dropdown-subitem"><a href="/java/topic/" class="nav-link">
  专题系列
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="mysql" class="dropdown-title"><span class="title">MySQL专题</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          MySQL8.0官方手册中文版
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/mysql/manual/" class="nav-link">
  手册概述
</a></li><li class="dropdown-subitem"><a href="/mysql/manual-1/" class="nav-link">
  1 基本信息
</a></li><li class="dropdown-subitem"><a href="/mysql/manual-3/" class="nav-link">
  3 入门教程
</a></li></ul></li><li class="dropdown-item"><h4>
          MySQL进阶
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/mysql/advance/" class="nav-link">
  MySQL优化
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="share" class="dropdown-title"><span class="title">分享</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          个人分享
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/share/theoretical/" class="nav-link">
  理论见深度
</a></li><li class="dropdown-subitem"><a href="/share/technical/" class="nav-link">
  实践出真知
</a></li></ul></li><li class="dropdown-item"><h4>
          百家之长
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/share/top/" class="nav-link">
  公众号精品
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="https://github.com/qisong3" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Contact
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="source" class="dropdown-title"><span class="title">源码系列</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          Java源码
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/source/java-collections/" class="nav-link router-link-active">
  集合
</a></li><li class="dropdown-subitem"><a href="/source/java-wrapper/" class="nav-link">
  包装类
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="algorithm" class="dropdown-title"><span class="title">算法</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          数据结构
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/algorithm/array/" class="nav-link">
  数组
</a></li><li class="dropdown-subitem"><a href="/algorithm/stack.html" class="nav-link">
  栈
</a></li><li class="dropdown-subitem"><a href="/algorithm/heap/" class="nav-link">
  堆
</a></li><li class="dropdown-subitem"><a href="/algorithm/tree.html" class="nav-link">
  树
</a></li><li class="dropdown-subitem"><a href="/algorithm/graph.html" class="nav-link">
  图
</a></li><li class="dropdown-subitem"><a href="/algorithm/hashtable.html" class="nav-link">
  哈希表
</a></li></ul></li><li class="dropdown-item"><h4>
          算法
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/algorithm/greedy.html" class="nav-link">
  贪心
</a></li><li class="dropdown-subitem"><a href="/algorithm/backtracking.html" class="nav-link">
  回溯
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="java" class="dropdown-title"><span class="title">Java专题</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          Java基础
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/java/history/" class="nav-link">
  Java简史
</a></li></ul></li><li class="dropdown-item"><h4>
          Java深入
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/java/review/" class="nav-link">
  面试集锦
</a></li><li class="dropdown-subitem"><a href="/java/topic/" class="nav-link">
  专题系列
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="mysql" class="dropdown-title"><span class="title">MySQL专题</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          MySQL8.0官方手册中文版
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/mysql/manual/" class="nav-link">
  手册概述
</a></li><li class="dropdown-subitem"><a href="/mysql/manual-1/" class="nav-link">
  1 基本信息
</a></li><li class="dropdown-subitem"><a href="/mysql/manual-3/" class="nav-link">
  3 入门教程
</a></li></ul></li><li class="dropdown-item"><h4>
          MySQL进阶
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/mysql/advance/" class="nav-link">
  MySQL优化
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="share" class="dropdown-title"><span class="title">分享</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          个人分享
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/share/theoretical/" class="nav-link">
  理论见深度
</a></li><li class="dropdown-subitem"><a href="/share/technical/" class="nav-link">
  实践出真知
</a></li></ul></li><li class="dropdown-item"><h4>
          百家之长
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/share/top/" class="nav-link">
  公众号精品
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="https://github.com/qisong3" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Contact
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Java集合</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/source/java-collections/" aria-current="page" class="sidebar-link">Java容器源码解读</a></li><li><a href="/source/java-collections/JDK8——HashMap源码解读.html" class="sidebar-link">JDK8——HashMap源码解读</a></li><li><a href="/source/java-collections/JDK8——ArrayList源码解读.html" class="active sidebar-link">JDK8——ArrayList源码解读</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/source/java-collections/JDK8——ArrayList源码解读.html#概述" class="sidebar-link">概述</a></li><li class="sidebar-sub-header"><a href="/source/java-collections/JDK8——ArrayList源码解读.html#成员变量" class="sidebar-link">成员变量</a></li><li class="sidebar-sub-header"><a href="/source/java-collections/JDK8——ArrayList源码解读.html#函数解析" class="sidebar-link">函数解析</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/source/java-collections/JDK8——ArrayList源码解读.html#构造函数" class="sidebar-link">构造函数</a></li><li class="sidebar-sub-header"><a href="/source/java-collections/JDK8——ArrayList源码解读.html#增加元素" class="sidebar-link">增加元素</a></li><li class="sidebar-sub-header"><a href="/source/java-collections/JDK8——ArrayList源码解读.html#查找-修改元素" class="sidebar-link">查找 修改元素</a></li><li class="sidebar-sub-header"><a href="/source/java-collections/JDK8——ArrayList源码解读.html#删除元素" class="sidebar-link">删除元素</a></li><li class="sidebar-sub-header"><a href="/source/java-collections/JDK8——ArrayList源码解读.html#列表销毁" class="sidebar-link">列表销毁</a></li></ul></li><li class="sidebar-sub-header"><a href="/source/java-collections/JDK8——ArrayList源码解读.html#小结" class="sidebar-link">小结</a></li></ul></li><li><a href="/source/java-collections/JDK8——LinkedList源码解读.html" class="sidebar-link">JDK8——LinkedList源码解读</a></li><li><a href="/source/java-collections/JDK8——Vector源码解读.html" class="sidebar-link">JDK8——Vector源码解读</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="概述"><a href="#概述" class="header-anchor">#</a> 概述</h2> <p>ArrayList是一种常用List类型实现，也是Java集合中的的常用类型，以遍历查询性能优异著称，继承关系如下：
<img src="/images/java-source/arraylist-1.png" alt="ArrayList继承">
可见ArrayList实现了Cloneable，Serializable，RandomAcess和List接口，继承了AbstractList抽象类，简而言之，ArrayList是一个实现了可复制，可序列化，支持快速随机访问的List类型。</p> <p>这里最重要的是实现了List的接口，包括初始化，新增，查询，删除，销毁等函数，具体如何实现，请见下文分析。</p> <h2 id="成员变量"><a href="#成员变量" class="header-anchor">#</a> 成员变量</h2> <div class="language-java line-numbers-mode"><pre class="language-java"><code>     <span class="token comment">/**
     * List默认初始化长度
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> DEFAULT_CAPACITY <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
 
    <span class="token comment">/**
     * 存储ArrayList数据的数组
     */</span>
    <span class="token keyword">transient</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> elementData<span class="token punctuation">;</span>
 
    <span class="token comment">/**
     * List的实际长度
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> size<span class="token punctuation">;</span>
 
    <span class="token comment">/**
     * ArrayList最大长度
     */</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> MAX_ARRAY_SIZE <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span>MAX_VALUE <span class="token operator">-</span> <span class="token number">8</span><span class="token punctuation">;</span>    
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>这里列出了三个重要的变量，具体释义见注释。ArrayList在初始化时默认为空的数组，当首个元素加入到List中时，长度扩容到10。size是数组的实际容量，也即是List的大小，初始化为0。</p> <p>elementData是Object类型的数组，也是实际存放数据的数组。以Object作为数组元素使得List可以有效支持泛型。</p> <p>这里有一点需要注意，既然elementData用来存放元素，那为何不使用elementData.length而是使用size这一变量作为ArrayList的长度呢？在下文中会结合使用进行说明。</p> <h2 id="函数解析"><a href="#函数解析" class="header-anchor">#</a> 函数解析</h2> <h3 id="构造函数"><a href="#构造函数" class="header-anchor">#</a> 构造函数</h3> <div class="language-java line-numbers-mode"><pre class="language-java"><code>  <span class="token comment">/**                                                                               
   * Constructs an empty list with the specified initial capacity.                  
   *                                                                                
   * @param  initialCapacity  the initial capacity of the list                      
   * @throws IllegalArgumentException if the specified initial capacity             
   *         is negative                                                            
   */</span>                                                                               
  <span class="token keyword">public</span> <span class="token class-name">ArrayList</span><span class="token punctuation">(</span><span class="token keyword">int</span> initialCapacity<span class="token punctuation">)</span> <span class="token punctuation">{</span>                                           
      <span class="token keyword">if</span> <span class="token punctuation">(</span>initialCapacity <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                                                    
          <span class="token keyword">this</span><span class="token punctuation">.</span>elementData <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">[</span>initialCapacity<span class="token punctuation">]</span><span class="token punctuation">;</span>                           
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>initialCapacity <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                                            
          <span class="token keyword">this</span><span class="token punctuation">.</span>elementData <span class="token operator">=</span> EMPTY_ELEMENTDATA<span class="token punctuation">;</span>                                     
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>                                                                      
          <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span><span class="token string">&quot;Illegal Capacity: &quot;</span><span class="token operator">+</span>                  
                                             initialCapacity<span class="token punctuation">)</span><span class="token punctuation">;</span>                      
      <span class="token punctuation">}</span>                                                                             
  <span class="token punctuation">}</span>                                                                                 
                                                                                    
  <span class="token comment">/**                                                                               
   * Constructs an empty list with an initial capacity of ten.                      
   */</span>                                                                               
  <span class="token keyword">public</span> <span class="token class-name">ArrayList</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                                                              
      <span class="token keyword">this</span><span class="token punctuation">.</span>elementData <span class="token operator">=</span> DEFAULTCAPACITY_EMPTY_ELEMENTDATA<span class="token punctuation">;</span>                         
  <span class="token punctuation">}</span>                                                                                 
                                                                                    
  <span class="token comment">/**                                                                               
   * Constructs a list containing the elements of the specified                     
   * collection, in the order they are returned by the collection's                 
   * iterator.                                                                      
   *                                                                                
   * @param c the collection whose elements are to be placed into this list         
   * @throws NullPointerException if the specified collection is null               
   */</span>                                                                               
  <span class="token keyword">public</span> <span class="token class-name">ArrayList</span><span class="token punctuation">(</span><span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">E</span><span class="token punctuation">&gt;</span></span> c<span class="token punctuation">)</span> <span class="token punctuation">{</span>                                     
      elementData <span class="token operator">=</span> c<span class="token punctuation">.</span><span class="token function">toArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                                                    
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>size <span class="token operator">=</span> elementData<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                                       
          <span class="token comment">// defend against c.toArray (incorrectly) not returning Object[]          </span>
          <span class="token comment">// (see e.g. https://bugs.openjdk.java.net/browse/JDK-6260652)            </span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>elementData<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>                             
              elementData <span class="token operator">=</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">copyOf</span><span class="token punctuation">(</span>elementData<span class="token punctuation">,</span> size<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>                                                                      
          <span class="token comment">// replace with empty array.                                              </span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>elementData <span class="token operator">=</span> EMPTY_ELEMENTDATA<span class="token punctuation">;</span>                                     
      <span class="token punctuation">}</span>                                                                             
  <span class="token punctuation">}</span>                                                                                  
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br></div></div><p>构造函数有三个：</p> <ul><li>无参构造函数：elementData初始化为空数组，此时size默认为0。</li> <li>初始化长度构造函数：elementData扩容为指定长度的未初始化数组。注意这里size并没有被设置为指定长度，此时elementData.length和size是不一致的。实际上elementData.length表示当前ArrayList的最大容量，而size则表示了实际存放元素的个数。</li> <li>容器初始化函数：通过容器已有数据构造ArrayList。</li></ul> <h3 id="增加元素"><a href="#增加元素" class="header-anchor">#</a> 增加元素</h3> <div class="language-java line-numbers-mode"><pre class="language-java"><code> <span class="token comment">/**                                                                          
  * Inserts the specified element at the specified position in this           
  * list. Shifts the element currently at that position (if any) and          
  * any subsequent elements to the right (adds one to their indices).         
  *                                                                           
  * @param index index at which the specified element is to be inserted       
  * @param element element to be inserted                                     
  * @throws IndexOutOfBoundsException {@inheritDoc}                           
  */</span>                                                                          
 <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">,</span> <span class="token class-name">E</span> element<span class="token punctuation">)</span> <span class="token punctuation">{</span>                                      
     <span class="token function">rangeCheckForAdd</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>                                                 
     modCount<span class="token operator">++</span><span class="token punctuation">;</span>                                                              
     <span class="token keyword">final</span> <span class="token keyword">int</span> s<span class="token punctuation">;</span>                                                             
     <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> elementData<span class="token punctuation">;</span>                                                    
     <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>s <span class="token operator">=</span> size<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token punctuation">(</span>elementData <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>elementData<span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span>               
         elementData <span class="token operator">=</span> <span class="token function">grow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                                                
     <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">arraycopy</span><span class="token punctuation">(</span>elementData<span class="token punctuation">,</span> index<span class="token punctuation">,</span>                                     
                      elementData<span class="token punctuation">,</span> index <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span>                                 
                      s <span class="token operator">-</span> index<span class="token punctuation">)</span><span class="token punctuation">;</span>                                             
     elementData<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> element<span class="token punctuation">;</span>                                            
     size <span class="token operator">=</span> s <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>                                                            
 <span class="token punctuation">}</span>                                                                     
 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>add函数重载的包括多个，这里只列出一个具有代表性的进行说明，其他的add方法可由它推演而来。这个函数做了这么几件事，首先检查要插入的下标是否越界，是的话直接抛异常退出。然后检查elementData.length和size是否一致，一致说明容量已满，需要扩容，增加一个元素的容量。将index之后的元素分别拷贝到原下标+1的位置，将index位置设为指定element，并将ArrayList的实际长度加一。</p> <p>这一步骤的关键，或者说ArrayList的关键，在于扩容，来看一下扩容的实现。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>   <span class="token comment">/**                                                                    
    * Increases the capacity to ensure that it can hold at least the      
    * number of elements specified by the minimum capacity argument.      
    *                                                                     
    * @param minCapacity the desired minimum capacity                     
    * @throws OutOfMemoryError if minCapacity is less than zero           
    */</span>                                                                    
   <span class="token keyword">private</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">grow</span><span class="token punctuation">(</span><span class="token keyword">int</span> minCapacity<span class="token punctuation">)</span> <span class="token punctuation">{</span>                               
       <span class="token keyword">return</span> elementData <span class="token operator">=</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">copyOf</span><span class="token punctuation">(</span>elementData<span class="token punctuation">,</span>                    
                                          <span class="token function">newCapacity</span><span class="token punctuation">(</span>minCapacity<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      
   <span class="token punctuation">}</span>                                                                      
                                                                          
   <span class="token keyword">private</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">grow</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                                              
       <span class="token keyword">return</span> <span class="token function">grow</span><span class="token punctuation">(</span>size <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                                             
   <span class="token punctuation">}</span>                                                                      
                                                                          
   <span class="token comment">/**                                                                    
    * Returns a capacity at least as large as the given minimum capacity. 
    * Returns the current capacity increased by 50% if that suffices.     
    * Will not return a capacity greater than MAX_ARRAY_SIZE unless       
    * the given minimum capacity is greater than MAX_ARRAY_SIZE.          
    *                                                                     
    * @param minCapacity the desired minimum capacity                     
    * @throws OutOfMemoryError if minCapacity is less than zero           
    */</span>                                                                    
   <span class="token keyword">private</span> <span class="token keyword">int</span> <span class="token function">newCapacity</span><span class="token punctuation">(</span><span class="token keyword">int</span> minCapacity<span class="token punctuation">)</span> <span class="token punctuation">{</span>                             
       <span class="token comment">// overflow-conscious code                                         </span>
       <span class="token keyword">int</span> oldCapacity <span class="token operator">=</span> elementData<span class="token punctuation">.</span>length<span class="token punctuation">;</span>                              
       <span class="token keyword">int</span> newCapacity <span class="token operator">=</span> oldCapacity <span class="token operator">+</span> <span class="token punctuation">(</span>oldCapacity <span class="token operator">&gt;&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                
       <span class="token keyword">if</span> <span class="token punctuation">(</span>newCapacity <span class="token operator">-</span> minCapacity <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                              
           <span class="token keyword">if</span> <span class="token punctuation">(</span>elementData <span class="token operator">==</span> DEFAULTCAPACITY_EMPTY_ELEMENTDATA<span class="token punctuation">)</span>          
               <span class="token keyword">return</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>DEFAULT_CAPACITY<span class="token punctuation">,</span> minCapacity<span class="token punctuation">)</span><span class="token punctuation">;</span>            
           <span class="token keyword">if</span> <span class="token punctuation">(</span>minCapacity <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">// overflow                               </span>
               <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">OutOfMemoryError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                              
           <span class="token keyword">return</span> minCapacity<span class="token punctuation">;</span>                                            
       <span class="token punctuation">}</span>                                                                  
       <span class="token keyword">return</span> <span class="token punctuation">(</span>newCapacity <span class="token operator">-</span> MAX_ARRAY_SIZE <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span>                         
           <span class="token operator">?</span> newCapacity                                                  
           <span class="token operator">:</span> <span class="token function">hugeCapacity</span><span class="token punctuation">(</span>minCapacity<span class="token punctuation">)</span><span class="token punctuation">;</span>      
   <span class="token punctuation">}</span>                              
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div><p>当ArrayList容量不够时，默认需要增加一个元素的长度。在实际执行过程中，是扩容到之前容量的1.5倍，然后判断是否超过最大限制，超过则报内存溢出错误。在扩容过程中，最大不得超过MAX_ARRAY_SIZE，即ArrayList的最大长度。</p> <p>由此可见，向ArrayList插入元素时，当元素个数小于实际容量大小时，只要进行部分数组的拷贝工作，容量已满时，需要扩容则要将ArrayList的所有元素拷贝到新建数组中，这个步骤是比较耗时的。元素的插入确实不是ArrayList的强项。</p> <h3 id="查找-修改元素"><a href="#查找-修改元素" class="header-anchor">#</a> 查找 修改元素</h3> <p>查询和修改实际是通过下标来访问和修改数组元素，时间复杂度只有O(1)，相对于LinkedList和其他容器，都具有绝对的速度优势。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>   <span class="token comment">/**                                                                                  
    * Returns the element at the specified position in this list.                       
    *                                                                                   
    * @param  index index of the element to return                                      
    * @return the element at the specified position in this list                        
    * @throws IndexOutOfBoundsException {@inheritDoc}                                   
    */</span>                                                                                  
   <span class="token keyword">public</span> <span class="token class-name">E</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">)</span> <span class="token punctuation">{</span>                                                            
       <span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">checkIndex</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> size<span class="token punctuation">)</span><span class="token punctuation">;</span>                                                 
       <span class="token keyword">return</span> <span class="token function">elementData</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>                                                       
   <span class="token punctuation">}</span>                                                                                    
                                                                                        
   <span class="token comment">/**                                                                                  
    * Replaces the element at the specified position in this list with                  
    * the specified element.                                                            
    *                                                                                   
    * @param index index of the element to replace                                      
    * @param element element to be stored at the specified position                     
    * @return the element previously at the specified position                          
    * @throws IndexOutOfBoundsException {@inheritDoc}                                   
    */</span>                                                                                  
   <span class="token keyword">public</span> <span class="token class-name">E</span> <span class="token function">set</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">,</span> <span class="token class-name">E</span> element<span class="token punctuation">)</span> <span class="token punctuation">{</span>                                                 
       <span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">checkIndex</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> size<span class="token punctuation">)</span><span class="token punctuation">;</span>                                                 
       <span class="token class-name">E</span> oldValue <span class="token operator">=</span> <span class="token function">elementData</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>                                                 
       elementData<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> element<span class="token punctuation">;</span>                                                    
       <span class="token keyword">return</span> oldValue<span class="token punctuation">;</span>                                                                 
   <span class="token punctuation">}</span>                                                                                    

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><p>只是进行下标检测，获取或者替换指定index位置的元素。</p> <h3 id="删除元素"><a href="#删除元素" class="header-anchor">#</a> 删除元素</h3> <p>删除元素对ArrayList来说也有一定的工作量，需要将指定index位置以后的元素统统向前移位，如果ArrayList较长且删除元素的位置靠前，这就是一个比较耗时的操作了</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>   <span class="token comment">/**                                                                                
    * Removes the element at the specified position in this list.                     
    * Shifts any subsequent elements to the left (subtracts one from their            
    * indices).                                                                       
    *                                                                                 
    * @param index the index of the element to be removed                             
    * @return the element that was removed from the list                              
    * @throws IndexOutOfBoundsException {@inheritDoc}                                 
    */</span>                                                                                
   <span class="token keyword">public</span> <span class="token class-name">E</span> <span class="token function">remove</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">)</span> <span class="token punctuation">{</span>                                                       
       <span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">checkIndex</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> size<span class="token punctuation">)</span><span class="token punctuation">;</span>                                               
                                                                                      
       modCount<span class="token operator">++</span><span class="token punctuation">;</span>                                                                    
       <span class="token class-name">E</span> oldValue <span class="token operator">=</span> <span class="token function">elementData</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>                                               
                                                                                      
       <span class="token keyword">int</span> numMoved <span class="token operator">=</span> size <span class="token operator">-</span> index <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>                                               
       <span class="token keyword">if</span> <span class="token punctuation">(</span>numMoved <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>                                                              
           <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">arraycopy</span><span class="token punctuation">(</span>elementData<span class="token punctuation">,</span> index<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> elementData<span class="token punctuation">,</span> index<span class="token punctuation">,</span>                 
                            numMoved<span class="token punctuation">)</span><span class="token punctuation">;</span>                                                
       elementData<span class="token punctuation">[</span><span class="token operator">--</span>size<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span> <span class="token comment">// clear to let GC do its work                                                                                              </span>
       <span class="token keyword">return</span> oldValue<span class="token punctuation">;</span>                                                               
   <span class="token punctuation">}</span>                                                                                  
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>这里还需要注意，实际上，删除元素时，并没有新建一个数组将原数组拷贝进去，而拷贝元素后将原先末尾的位置置为null并且减小size。这里再提出一个问题，将数组元素的最后一位设为null后，虚拟机会对该位置进行垃圾回收吗，数组的实际长度变化了吗？</p> <h3 id="列表销毁"><a href="#列表销毁" class="header-anchor">#</a> 列表销毁</h3> <p>最后看ArrayList的销毁。销毁比较简单，只是把数组各元素置为null，并且将size设为0。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>  <span class="token comment">/**                                                              
   * Removes all of the elements from this list.  The list will    
   * be empty after this call returns.                             
   */</span>                                                              
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                                            
      modCount<span class="token operator">++</span><span class="token punctuation">;</span>                                                  
      <span class="token keyword">final</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> es <span class="token operator">=</span> elementData<span class="token punctuation">;</span>                             
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token keyword">to</span> <span class="token operator">=</span> size<span class="token punctuation">,</span> i <span class="token operator">=</span> size <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token keyword">to</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>               
          es<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>                                            
  <span class="token punctuation">}</span>                                                                
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="小结"><a href="#小结" class="header-anchor">#</a> 小结</h2> <p>容器最重要的功能是存储和获取元素，本文从源码角度介绍了ArrayList的增删改查和原理，ArrayList还有一些其他未提到的特性，将在后面的文章中展示。</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/qisong3/Techblog/edit/master/docs/source/java-collections/JDK8——ArrayList源码解读.md" target="_blank" rel="noopener noreferrer">在Github上编辑此页</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/source/java-collections/JDK8——HashMap源码解读.html" class="prev">
        JDK8——HashMap源码解读
      </a></span> <span class="next"><a href="/source/java-collections/JDK8——LinkedList源码解读.html">
        JDK8——LinkedList源码解读
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/assets/js/app.e0118352.js" defer></script><script src="/assets/js/3.3e98eff2.js" defer></script><script src="/assets/js/56.98a84191.js" defer></script><script src="/assets/js/6.8fb5b480.js" defer></script>
  </body>
</html>
